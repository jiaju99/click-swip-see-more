/*flupmore.js version-20150526-cs. click or swipe up to get next page via jsonp ajax togs.https://github.com/jiaju99/tabtogs */
function fl_load1(a,b){var c,d,e,f;for(c=1;a>=c;c++)d=$("#more"+c),e=$("#morefu"+c),f=wrap,fl_outputp(d,e,0),b&&fl_swipetp(d,e,0,f,0)}function fl_load2(a,b,c){var d,e,f,g;for(d=1;a>=d;d++)e=$("#more"+d),f=$("#morefu"+d),g=wrap,b&&(f=$("#morefu1")),d==c&&fl_outputp(e,f,0),fl_clicktp(e,f,b),fl_swipetp(e,f,0,g,1)}function fl_beforetp(){loadinfo.html('<i class="icw iw2 iload"></i>loading....').show()}function fl_failtp(){loadinfo.html("加载失败").show().fadeOut(800)}function fl_donetp(){gotp=1}function fl_endtp(a){loadinfo.html("加载完毕").show().fadeOut(800),a.find(".nextstep").removeClass("hide"),gotp=1}function fl_outputp(a,b,c){var i,d=parseFloat(a.attr("data-pageto")),e=parseFloat(a.attr("data-maxpg")),f=e>=d||!e,g=a.attr("data-url"),h=baseurl+g;c&&(d=1,f=1),i=function(e){var g,h,i,j,k;console.log("torequestpageto"+d+"="+f+"="+e.jsonurl),g=parseFloat(e.maxpage),h=parseFloat(e.paged),g&&g>=h?(a.attr("data-maxpg",g).attr("data-pageto",d+1),i=a.attr("data-what"),j=flobjlis(e.objects,i),c&&$(b).html(""),$(j).appendTo(b),loadinfo.fadeOut(800)):g?fl_endtp(b):(k=a.attr("data-notip"),loadinfo.html(k).show())},f?(a.attr("data-pageto",d+1),fl_jsonp(h,"pageto="+d,fl_beforetp,i,fl_failtp,fl_donetp)):fl_endtp(b)}function fl_clicktp(a,b,c){a.click(function(){fl_outputp(a,b,c)})}function fl_swipetp(a,b,c,d,e){d.on("swipe",function(f){"up"==f.direction&&(e?a.hasClass("now")&&(console.log(a.attr("id")),fl_bartp(a,b,c,d)):fl_bartp(a,b,c,d))})}function fl_bartp(a,b,c,d){var e=d.eq(0)[0].clientHeight,f=d.eq(0)[0].scrollHeight,g=f-e,h=d.scrollTop(),i=g-h;0>=i&&gotp&&(gotp=0,fl_outputp(a,b,c))}var loadinfo,gotp,wrap=$(".wrap");$('<p class="loadinfo" style="display:none;"></p>').appendTo(wrap),loadinfo=$(".loadinfo"),gotp=1;


/*20150317-feilong.org*/
